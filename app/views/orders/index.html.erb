<div class="container mt-5">
  <%# Status %>
  <h1>Welcome back <%= current_user.name %>!</h1>
  <div class="d-flex">
    <div class="card-banner" style="background-image: url(<%= asset_path('carbon_card') %>);">
      <h4>So far you’ve rescued 123 ingredients and saved 435 kg of CO2</h4>
      <%= link_to "Learn more", class:"btn btn-primary" %>
    </div>
    <div class="card-banner" style="background-image: url(<%= asset_path('bush_card') %>); color: white;">
      <h4>You’re a earth saver</h4>
      <p>Save another 200 kg to unlock next level and receive more discounts </p>
      <p>Learn more</p>
    </div>
  </div>
  <hr>
  <%# Order %>
  <h1>All orders</h1>
  <%# Tabs %>
  <div class="w3-bar w3-black">
    <button class="w3-bar-item w3-button" onclick="openCity('complete-order')">Completed Orders</button>
    <button class="w3-bar-item w3-button" onclick="openCity('not-complete-order')">Wait for pickup</button>
  </div>
  <%# Content %>
  <%# Commplete orders %>
  <div id="complete-order" class="w3-container city">
    <h2>Commpleted</h2>
    <% if @collected_orders.count == 0 %>
      <h2>No orders</h2>
    <% else %>
      <h2>All orders</h2>
      <% @collected_orders.each do |collected_order| %>
        <% collected_order.ingredients.each do |ingredient| %>
          <%= ingredient.seller.restaurant.name %>
          <%= ingredient.name %> <%= ingredient.expiry_date %>
          <%= cl_image_tag ingredient.photo.key, height: 100, width: 100, crop: :fill %>
        <% end %>
        Payment: <%= collected_order.pay_method %><br>
        Total: $<%= collected_order.total_price %><br>
        Status: <%= collected_order.status %>
      <% end %>
    <% end %>
  </div>
  <%# Not collected orders %>
  <div id="not-complete-order" class="w3-container city" style="display:none">
    <h2>Wait for pickup</h2>
    <% if @not_collected_orders.count == 0 %>
      <h2>No orders</h2>
    <% else %>
      <h2>All orders</h2>
      <% @not_collected_orders.each do |not_collected_order| %>
        <% not_collected_order.ingredients.each do |ingredient| %>
          <%= ingredient.seller.restaurant.name %>
          <%= ingredient.name %> <%= ingredient.expiry_date %>
          <%= cl_image_tag ingredient.photo.key, height: 100, width: 100, crop: :fill %>
        <% end %>
        Payment: <%= not_collected_order.pay_method %><br>
        Total: $<%= not_collected_order.total_price %><br>
        Status: <%= not_collected_order.status %>
      <% end %>
    <% end %>
  </div>
  <%# Javascript for tab %>
  <script>
    function openCity(cityName) {
      var i;
      var x = document.getElementsByClassName("city");
      for (i = 0; i < x.length; i++) {
        x[i].style.display = "none";
      }
      document.getElementById(cityName).style.display = "block";
    }
  </script>
