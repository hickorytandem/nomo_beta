<div class="container mt-5">
  <%# Status %>
  <h1>Welcome back <%= current_user.name %>!</h1>
  <div class="d-flex">
    <div class="card-banner" style="background-image: url(<%= asset_path('carbon_card') %>);">
      <h4>So far you’ve rescued 123 ingredients and saved 435 kg of CO2</h4>
      <%= link_to "Learn more", class:"btn btn-primary" %>
    </div>
    <div class="card-banner" style="background-image: url(<%= asset_path('bush_card') %>); color: white;">
      <h4>You’re a earth saver</h4>
      <p>Save another 200 kg to unlock next level and receive more discounts </p>
      <p>Learn more</p>
    </div>
  </div>
  <hr>
  <%# Order %>
  <h1>All orders</h1>
  <%# Tabs %>
  <div class="w3-bar w3-black">
    <button class="w3-bar-item w3-button" onclick="openOrder('all-orders')">All orders</button>
    <button class="w3-bar-item w3-button" onclick="openOrder('not-collected')">Wait for pickup</button>
  </div>
  <%# Contents %>
  <ul>
    <% @orders.each do |order| %>
      <% if order.status == "collected" %>
        <div id="all-orders" class="order">
          <h2>All orders</h2>
          <% order.ingredients.each do |ingredient| %>
            <li><%= ingredient.seller.restaurant.name %></li>
            <%= ingredient.name %> <%= ingredient.expiry_date %>
            <%# <%= cl_image_tag ingredient.photo.key %> %>
          <% end %>
          Payment: <%= order.pay_method %>
          Total: $<%= order.total_price %>
          Status: <%= order.status %>
        </div>
      <% else %>
        <div id="not-collected" class="order" style="display:none">
          <% if @not_collected_orders.count == 0 %>
            <% order.ingredients.each do |ingredient| %>
              <h2>Wait for pickup</h2>
              <li><%= ingredient.seller.restaurant.name %></li>
              <%= ingredient.name %> <%= ingredient.expiry_date %>
              <%# <%= cl_image_tag ingredient.photo.key %> %>
            <% end %>
            Payment: <%= order.pay_method %>
            Total: $<%= order.total_price %>
            Status: <%= order.status %>
          <% else %>
            <h2>No orders</h2>
          <% end %>
        </div>
      <% end %>
    <% end %>
  </ul>
  <%# Javascript for tab %>
  <script>
    function openOrder(cityName) {
      var i;
      var x = document.getElementsByClassName("order");
      for (i = 0; i < x.length; i++) {
        x[i].style.display = "none";
      }
      document.getElementById(cityName).style.display = "block";
    }
  </script>
